/*!
 * WinWin 1.0
 * @author Andy Mikulski <github.com/andymikulski>
 * @url https://github.com/andymikulski/winwin
 */
;(function(c,l,m){c.WinWin={boundEvents:{},namedEvents:{},flaggedEvents:{},isLooping:!1,_hasInit:!1,init:function(){this._hasInit||(this._hasInit=!0,this._rafShim());return this},bind:function(a,b,d){a=a.split(" ");var f,c;for(c=a.length-1;0<=c;c--)if(f=a[c],this.boundEvents.hasOwnProperty(f)||this._registerNewEvent(f),this.boundEvents[f].push(b),d){if(-1<a.indexOf(d)){console&&console.warn&&console.warn('WinWin : bind : binding name "'+d+'" can not be the same name as the event ("'+a+'")');break}this.namedEvents.hasOwnProperty(d)||
(this.namedEvents[d]=[]);this.namedEvents[d].push(f+"|"+this.boundEvents[f].length)}return this},unbind:function(a){var b;if(a&&""!==a)if(this.hasBinding(a)){if(b=this.boundEvents[a])b.length=0;delete this.flaggedEvents[a]}else this.hasNamedBinding(a)?this._unbindNamed(a):console&&console.warn&&console.warn('WinWin : unbind : no "'+a+'" to unbind');else this.unbindAll();return this},unbindAll:function(){for(var a in this.boundEvents){var b=this.boundEvents[a];b&&(b.length=0)}for(a in this.namedEvents)if(b=
this.namedEvents[a])b.length=0;for(a in this.flaggedEvents)if(b=this.flaggedEvents[a])b.length=0;return this},hasBinding:function(a){return this.boundEvents.hasOwnProperty(a)},hasNamedBinding:function(a){return this.namedEvents.hasOwnProperty(a)},_unbindNamed:function(a){var b=this.namedEvents[a],d,c;if(b&&b.length){for(var e=b.length-1;0<=e;e--)d=b[e].split("|"),c=d[0],d=d[1]-1,this.boundEvents.hasOwnProperty(c)&&(this.boundEvents[c][d]=null);delete this.namedEvents[a]}return this},_registerNewEvent:function(a){var b=
this;b.boundEvents[a]=[];c.addEventListener(a,function(d){b._windowEventHandler(a,d)});b.flaggedEvents[a]=!0;return b},_windowEventHandler:function(a,b){this.flaggedEvents.hasOwnProperty(a)&&(this.flaggedEvents[a]=!0);return this},_fireEvents:function(){var a=this._getDirty(),b,d,c,e;for(c=a.length-1;0<=c;c--)if((b=this.boundEvents[a[c]])&&b.length)for(e=b.length-1;0<=e;e--)(d=b[e])&&"function"===typeof d&&d();return this},_resetFlags:function(){for(var a in this.flaggedEvents)this.flaggedEvents.hasOwnProperty(a)&&
(this.flaggedEvents[a]=!1);return this},_getDirty:function(){var a=this.flaggedEvents,b=[],c;for(c in a)!0===a[c]&&b.push(c);return b},_initLoop:function(){this.init();this.isLooping=!0;this._onTick();return this},_onTick:function(){if(!this.isLooping)return this;this._fireEvents()._resetFlags();c.requestAnimationFrame(this._onTick.bind(this));return this},_rafShim:function(){for(var a=0,b=["webkit","moz"],d=0;d<b.length&&!c.requestAnimationFrame;++d)c.requestAnimationFrame=c[b[d]+"RequestAnimationFrame"],
c.cancelAnimationFrame=c[b[d]+"CancelAnimationFrame"]||c[b[d]+"CancelRequestAnimationFrame"];c.requestAnimationFrame||(c.requestAnimationFrame=function(b,d){var g=(new Date).getTime(),h=Math.max(0,16-(g-a)),k=c.setTimeout(function(){b(g+h)},h);a=g+h;return k});c.cancelAnimationFrame||(c.cancelAnimationFrame=function(a){clearTimeout(a)})},start:function(){return this._initLoop()},pause:function(){this.isLooping=!1},stop:function(){return this.pause()},resume:function(){return this.start()}}.init()})(window,
document);